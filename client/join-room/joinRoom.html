<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<style>
.button{
	padding: 10px 17px;
  font-size: 15px;
  text-align: center;
  cursor: pointer;
  outline: none;
  color: black;
  background-color: white;
  border-radius: 7px;
}
#picture {
	position: absolute;
}
.display, .rectangle {
	position: absolute;
	z-index: 9999;
	width: 1000px;
	height: 700px;
	border-radius: 20px;
	background-color: #f4d942;
	border: 2px solid #ccc; 
}
.rectangle {
	top: 0px;
	left: 0px;
}	
#title{
	font-size: 30px;
}	
</style>
</head>
<body>
	<div id="joinRoom">
		<div class="rectangle">
			<p align="Center">JOIN ROOM</p>
			<div id="room-list" style="width: 500px; height: 100px; overflow-y: scroll">
				<form action="/hostRoom" method="GET">
				
				</form>
			</div>
			<div id="chat-text" style="width: 500px; height: 100px; overflow-y: scroll">
				<div>Enter a message!</div>
			</div>
			<form id="chat-form">
				<input id="chat-input" type="text" style="width: 500px"></input>

			</form><br>
			<form action="/characterSelect" method="GET">
				<input type="submit" style="align: 'left'" class ="button"id="buttonCharacterSelect" value="Character Select"/>
			</form>
		</div>
	</div>

<script>
$(document).ready(function() {
	var socket = io.connect();
	var user = sessionStorage.getItem("username");
	socket.on('connect', function(){
		socket.emit('joinRoom', 'JoinRoom');
		socket.emit('joinRoomConnection', user);
	});
	
	socket.on('updateRoomsList',function(room){
		console.log('UPDATE ROOM LIST', room);
		
		var id = room.id;
		document.getElementById('room-list').innerHTML += 
			'<form id="form'+id+'" action="/hostRoom" method="GET">'
			+room.roomName + ':<input type="submit" id="'+id+
			'" value="Join Room"><input type="hidden" name="id" value="'+id+'"></form>';
		
	});
	
	var chatText = document.getElementById('chat-text');
	var chatInput = document.getElementById('chat-input');
	var chatForm = document.getElementById('chat-form');
	
	// Updates the chat	
	socket.on('addToJoinRoomChat', function(data){
		chatText.innerHTML += '<div>' + data + '</div>';
	});

	chatForm.onsubmit = function(e){
		e.preventDefault();
		socket.emit('sendJoinRoomMsgToServer', user, chatInput.value);
		chatInput.value = '';      
	}
	
//	function onSubmit(){
//		socket.emit()	
//		return true;
//	}
});
</script>
</body>
</html>